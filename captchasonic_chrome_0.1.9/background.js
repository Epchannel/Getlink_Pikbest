var background=function(){"use strict";function j(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var P={exports:{}},q=P.exports,B;function U(){return B||(B=1,function(g,N){(function(k,I){I(g)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:q,function(k){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)k.exports=globalThis.browser;else{const I="The message port closed before a response was received.",v=T=>{const s={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(s).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class n extends WeakMap{constructor(r,a=void 0){super(a),this.createItem=r}get(r){return this.has(r)||this.set(r,this.createItem(r)),super.get(r)}}const m=e=>e&&typeof e=="object"&&typeof e.then=="function",i=(e,r)=>(...a)=>{T.runtime.lastError?e.reject(new Error(T.runtime.lastError.message)):r.singleCallbackArg||a.length<=1&&r.singleCallbackArg!==!1?e.resolve(a[0]):e.resolve(a)},f=e=>e==1?"argument":"arguments",_=(e,r)=>function(o,...x){if(x.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${f(r.minArgs)} for ${e}(), got ${x.length}`);if(x.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${f(r.maxArgs)} for ${e}(), got ${x.length}`);return new Promise((h,b)=>{if(r.fallbackToNoCallback)try{o[e](...x,i({resolve:h,reject:b},r))}catch(t){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,t),o[e](...x),r.fallbackToNoCallback=!1,r.noCallback=!0,h()}else r.noCallback?(o[e](...x),h()):o[e](...x,i({resolve:h,reject:b},r))})},d=(e,r,a)=>new Proxy(r,{apply(o,x,h){return a.call(x,e,...h)}});let A=Function.call.bind(Object.prototype.hasOwnProperty);const w=(e,r={},a={})=>{let o=Object.create(null),x={has(b,t){return t in e||t in o},get(b,t,E){if(t in o)return o[t];if(!(t in e))return;let u=e[t];if(typeof u=="function")if(typeof r[t]=="function")u=d(e,e[t],r[t]);else if(A(a,t)){let C=_(t,a[t]);u=d(e,e[t],C)}else u=u.bind(e);else if(typeof u=="object"&&u!==null&&(A(r,t)||A(a,t)))u=w(u,r[t],a[t]);else if(A(a,"*"))u=w(u,r[t],a["*"]);else return Object.defineProperty(o,t,{configurable:!0,enumerable:!0,get(){return e[t]},set(C){e[t]=C}}),u;return o[t]=u,u},set(b,t,E,u){return t in o?o[t]=E:e[t]=E,!0},defineProperty(b,t,E){return Reflect.defineProperty(o,t,E)},deleteProperty(b,t){return Reflect.deleteProperty(o,t)}},h=Object.create(e);return new Proxy(h,x)},c=e=>({addListener(r,a,...o){r.addListener(e.get(a),...o)},hasListener(r,a){return r.hasListener(e.get(a))},removeListener(r,a){r.removeListener(e.get(a))}}),R=new n(e=>typeof e!="function"?e:function(a){const o=w(a,{},{getContent:{minArgs:0,maxArgs:0}});e(o)}),y=new n(e=>typeof e!="function"?e:function(a,o,x){let h=!1,b,t=new Promise(O=>{b=function(p){h=!0,O(p)}}),E;try{E=e(a,o,b)}catch(O){E=Promise.reject(O)}const u=E!==!0&&m(E);if(E!==!0&&!u&&!h)return!1;const C=O=>{O.then(p=>{x(p)},p=>{let M;p&&(p instanceof Error||typeof p.message=="string")?M=p.message:M="An unexpected error occurred",x({__mozWebExtensionPolyfillReject__:!0,message:M})}).catch(p=>{console.error("Failed to send onMessage rejected reply",p)})};return C(u?E:t),!0}),z=({reject:e,resolve:r},a)=>{T.runtime.lastError?T.runtime.lastError.message===I?r():e(new Error(T.runtime.lastError.message)):a&&a.__mozWebExtensionPolyfillReject__?e(new Error(a.message)):r(a)},$=(e,r,a,...o)=>{if(o.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${f(r.minArgs)} for ${e}(), got ${o.length}`);if(o.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${f(r.maxArgs)} for ${e}(), got ${o.length}`);return new Promise((x,h)=>{const b=z.bind(null,{resolve:x,reject:h});o.push(b),a.sendMessage(...o)})},K={devtools:{network:{onRequestFinished:c(R)}},runtime:{onMessage:c(y),onMessageExternal:c(y),sendMessage:$.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:$.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},D={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return s.privacy={network:{"*":D},services:{"*":D},websites:{"*":D}},w(T,K,s)};k.exports=v(chrome)}})}(P)),P.exports}var H=U();const F=j(H);function W(g){return g==null||typeof g=="function"?{main:g}:g}const l=typeof F<"u"?F:typeof chrome<"u"?chrome:null,G=W(()=>{function g(){l.contextMenus.removeAll().then(()=>{[{title:"Pick the OCR Type",id:"ocrid",contexts:["page"]},{title:"Pick the OCR image element",id:"ocrPicker",contexts:["page"]},{title:"Pick the input element",id:"inputPicker",contexts:["page"]},{title:"Probot",parentId:"ocrid",id:"probot",contexts:["page"]},{title:"Amazon",parentId:"ocrid",id:"amazon",contexts:["page"]}].forEach(n=>{l.contextMenus.create(n,()=>{l.runtime.lastError&&console.error("Context menu creation error:",l.runtime.lastError)})})}).catch(s=>console.error("Error removing context menus:",s))}l.contextMenus.onClicked.addListener((s,n)=>{if(!n?.id)return;const m={menuItemId:s.menuItemId,...s.menuItemId==="ocrPicker"&&{picker:"ocrPicker"},...s.menuItemId==="inputPicker"&&{picker:"inputPicker"}};l.tabs.sendMessage(n.id,m,i=>{l.runtime.lastError&&console.error("Message sending error:",l.runtime.lastError)})}),l.runtime.onMessage.addListener((s,n,m)=>{if(s.type==="networkRequest")return N(s.payload).then(i=>m({success:!0,data:i})).catch(i=>m({success:!1,error:i.message})),!0;if(s.type==="feedback")return fetch("https://feedback.captchasonic.com/reportAccuracy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s.payload)}).then(i=>i.json()).then(i=>{m({success:!0,data:i})}).catch(i=>{m({success:!1,error:i.message})}),!0;if(s.action==="getTabId")return n.tab?m({tabId:n.tab.id}):chrome.tabs.query({active:!0,currentWindow:!0},i=>{const f=i[0]?.id||null;m({tabId:f})}),!0;if(s.type==="whileLoopCheck")return chrome.tabs.query({active:!0,currentWindow:!0},i=>{i[0]&&m({message:"globalCallback"})}),!0;s.action&&new Set(["popularCaptcha_refresh_iframes","ReCaptcha_refresh_iframes","ERROR_BAD_PARAMETERS","ERROR_TOO_BIG_CAPTCHA_FILESIZE","ERROR_ZERO_CAPTCHA_FILESIZE","ERROR_CAPTCHA_UNSOLVABLE","ERROR_BAD_IMGINSTRUCTIONS","ERROR_BAD_DUPLICATES","ERROR_NO_SUCH_METHOD","ERROR_KEY_DOES_NOT_EXIST","ERROR_ZERO_BALANCE","ERROR_DAILY_LIMIT_EXCEEDED","ERROR_QUOTA_LIMIT_EXCEEDED","ERROR_MINUTE_LIMIT_EXCEEDED"]).has(s.action)&&k(s.action)});async function N({url:s,method:n,headers:m,body:i}){const f=await fetch(s,{method:n||"GET",headers:m||{},body:n!=="GET"?i:void 0});if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);return f.headers.get("content-type")?.includes("application/json")?await f.json():await f.text()}async function k(s){try{const[n]=await l.tabs.query({active:!0,currentWindow:!0});if(!n?.id)return;await l.tabs.sendMessage(n.id,s)}catch(n){console.error("Error querying active tab:",n)}}async function I(){try{const s=await fetch(l.runtime.getURL("config/defaultConfig.json"));return s.ok?await s.json():null}catch(s){return console.error("Error loading default config:",s),null}}l.runtime.onInstalled.addListener(async s=>{g();const n=await I();if(s.reason==="install"){const m=await v();try{let i=await l.storage.local.get("userID");await l.storage.local.set({userID:m}),T("install",m)}catch(i){console.error("Error accessing storage:",i)}n&&await l.storage.local.set({settings:n}),n.GUIDE_PAGE&&l.tabs.create({url:"/guide.html"})}if(s.reason==="update"){let w=function(c,R){return c=c.filter(y=>R.includes(y)),R.forEach(y=>{c.includes(y)||c.push(y)}),c};const m=await v();try{let c=await l.storage.local.get("userID");await l.storage.local.set({userID:m}),T("update",m)}catch(c){console.error("Error accessing storage:",c)}const i=await l.storage.local.get("settings"),f=await l.storage.sync.get("settings"),d=(i?.settings?i:f).settings||{};let A={...n};A.APIKEY=n.APIKEY||d.APIKEY||"",A.ACTIVE=d.ACTIVE??n.ACTIVE,A.THEME=d.THEME||n.THEME,A.BLACKLISTENABLED=d.BLACKLISTENABLED??n.BLACKLISTENABLED,A.AUTOOPENENABLED=d.AUTOOPENENABLED??n.AUTOOPENENABLED,A.LOGENABLED=d.LOGENABLED??n.LOGENABLED,A.Local_lang=d.Local_lang||n.Local_lang,A.NOTIFICATION=d.NOTIFICATION??n.NOTIFICATION,A.CAPTCHAS=w(d.CAPTCHAS||[],n.CAPTCHAS),A.TITLES=w(d.TITLES||[],n.TITLES),A.OPTIONS={...d.OPTIONS};for(const c of Object.keys(n.OPTIONS))A.OPTIONS[c]?A.OPTIONS[c]={...n.OPTIONS[c],...d.OPTIONS[c]}:A.OPTIONS[c]=n.OPTIONS[c];await l.storage.local.set({settings:A}),console.log("Extension updated - settings merged successfully")}});async function v(){let s={browser:navigator.userAgent,platform:navigator.platform,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,cpuCores:navigator.hardwareConcurrency||"unknown",deviceMemory:navigator.deviceMemory||"unknown",installTimestamp:Date.now()};return btoa(JSON.stringify(s))}async function T(s,n){try{const m=await fetch("https://api.captchasonic.com/collect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:s,userID:n,timestamp:Date.now()})});m.ok||console.error(`Failed to send ${s} event:`,m.status)}catch(m){console.error(`Error sending ${s} event:`,m)}}l.runtime.onStartup.addListener(()=>{console.log("Extension initialized")})});function Y(){}function S(g,...N){}const Z={debug:(...g)=>S(console.debug,...g),log:(...g)=>S(console.log,...g),warn:(...g)=>S(console.warn,...g),error:(...g)=>S(console.error,...g)};let L;try{L=G.main(),L instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(g){throw Z.error("The background crashed on startup!"),g}return L}();
background;
